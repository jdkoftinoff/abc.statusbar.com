<!DOCTYPE html>
<html>
    <head>
        <title>AvbBwCalc</title>
        <meta http-equiv="Content-type" content="text/html; charset=utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
        <meta name="apple-mobile-web-app-capable" content="yes" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <meta name="apple-mobile-web-app-status-bar-style" content="black" />
        <link rel="stylesheet" type="text/css" href="css/icons.css" />
        <link rel="stylesheet" type="text/css" href="css/af.ui.css"  />
        <style type="text/css">
.scrollable {
position: absolute;
top: 50px;
left: 0;
right: 0;
bottom: 0;
overflow: scroll;
-webkit-overflow-scrolling: touch;
}
        </style>
        <script type="text/javascript" charset="utf-8" src="ui/appframework.ui.min.js"></script>
        <script type="text/javascript" charset="utf-8" src="avbcalc.js"></script>
        <script type="text/javascript">

if(navigator.userAgent.match(/Android/i)){
    window.scrollTo(0,1);
}

if (!((window.DocumentTouch && document instanceof DocumentTouch) || 'ontouchstart' in window)) {
    var script = document.createElement("script");
    script.src = "plugins/af.desktopBrowsers.js";
    var tag = $("head").append(script);
}


var init = function () {
        window.setTimeout(function () {
            $.ui.launch();
        }, 1500);


        var calculate = $("#calculate").get();

        calculate.onclick = function() {
            // The list of input parameters
            var input_items = [
                "network_speed_in_bps", "avb_bw", "stream_format", "sample_rate",
                "bits_per_sample", "channel_count", "async", "aes_gcm", "samples_per_frame" ];

            // The list of output parameters
            var output_items = [
                "status", "octets_per_frame", "micros_per_frame",
                "bw_per_stream_in_bps",
                "max_stream_count_per_net_link", "total_bw_used_in_bps",
                "leftover_bw_in_bps",
                "total_channels_per_net_link"
            ];

            // Extract the inputs from the form into one object
            var inputs = {};
            for( var i in input_items ) {
                var key=input_items[i];
                var val = $("#input_" + key ).val();
                inputs[key] = val;
            }

            // Calculate
            outputs = calculate_avb( inputs );

            // Store the outputs of the calculation into the form
            for( var i in output_items ) {
                var key=output_items[i];
                if( key ) {
                    var item = $("#output_" + key );
                    if( item && outputs[key] ) {
                        item.val( outputs[key] );
                    }
                }
            }

            $("#output_detail").text(JSON.stringify(outputs,undefined,2));
            $("#answers_button").click();

        }
};

document.addEventListener("DOMContentLoaded", init, false);


        </script>
    </head>
    <body><div id="afui"><div id="header"></div><div id="content" style="">
	<div class="panel scrollable" title="Inputs" id="page_inputs" selected="selected" data-appbuilder-object="page" style="width: 100%; min-height: 50px;">
        <div style="text-align:center;">avb.statusbar.com - 2014-01-26</div>
		<form style="width: 100%;min-height: 50px;" data-appbuilder-object="form" data-position="static" class="">
			<div class="select_element form_element" style="width: 100%; overflow: hidden;" data-appbuilder-object="select">
				<label for="input_network_speed_in_bps">Network Speed</label>
				<select id="input_network_speed_in_bps">
					<option value="100e6">100baseT</option>
					<option value="1e9" selected="">1 GigE</option>
					<option value="10e9">10 GigE</option>
					<option value="40e9">40 GigE</option>
				</select>
			</div>
			<div class="input_element form_element" style="width: 100%; overflow: hidden;" data-appbuilder-object="input">
				<label for="input_avb_bw">AVB BW Allocation (%)</label>
				<input type="text" style="float:left;" id="input_avb_bw" value="75">
			</div>
			<div class="select_element form_element" style="width: 100%; overflow: hidden;" data-appbuilder-object="select">
				<label for="input_stream_format">Stream Format</label>
				<select id="input_stream_format">
					<option value="AM824nb" selected="">AM824 (non blocking)</option>
					<option value="AM824b">AM824 (blocking)</option>
					<option value="AAF">AAF</option>
				</select>
			</div>
			<div class="select_element form_element" style="width: 100%; overflow: hidden;" data-appbuilder-object="select">
				<label for="input_sample_rate">Sample Rate</label>
				<select id="input_sample_rate">
					<option value="32000">32.0 kHz</option>
					<option value="44100">44.1 kHz</option>
					<option value="48000" selected="">48 kHz</option>
					<option value="88200">88.2 kHz</option>
					<option value="96000">96 kHz</option>
					<option value="176400">176.4 kHz</option>
					<option value="192000">192 kHz</option>
				</select>
			</div>
			<div class="select_element form_element" style="width: 100%; overflow: hidden;" data-appbuilder-object="select">
				<label for="input_bits_per_sample">Bits/Sample</label>
				<select id="input_bits_per_sample">
					<option value="16">16</option>
					<option value="24" selected="">24</option>
					<option value="32">32</option>
				</select>
			</div>
			<div class="select_element form_element" style="width: 100%; overflow: hidden;" data-appbuilder-object="select">
				<label for="input_samples_per_frame">AAF Samples/Frame</label>
				<select id="input_samples_per_frame">
					<option value="default" selected="">Default</option>
					<option value="1">1</option>
					<option value="2">2</option>
					<option value="3">3</option>
					<option value="4">4</option>
					<option value="6">6</option>
					<option value="12">12</option>
					<option value="24">24</option>
				</select>
			</div>
			<div class="input_element form_element" style="width: 100%; overflow: hidden;" data-appbuilder-object="input">
				<label for="input_channel_count">Channel Count</label>
				<input type="text" style="float:left;" id="input_channel_count" value="1">
			</div>
			<div class="input_element form_element" style="width: 100%; overflow: hidden;" data-appbuilder-object="input">
				<label for="input_aes_gcm">AES-GCM Encryption</label>
				<input type="text" style="float:left;" id="input_aes_gcm" value="1">
			</div>
			<div class="input_element form_element" style="width: 100%; overflow: hidden;" data-appbuilder-object="input">
				<label for="input_async">Async AM824</label>
				<input type="text" style="float:left;" id="input_async" value="0">
			</div>
		</form>
        <center><button id="calculate" style="width:50%; height:3em;">Calculate</button></center>
	</div>
	<div class="panel" title="Answers" id="page_answers" data-appbuilder-object="page" style="width: 100%; overflow: hidden;">
		<div class="container scrollable" style="width:100%" data-appbuilder-object="container" data-position="static">
			<div class="input_element form_element" style="width: 100%; overflow: hidden;" data-appbuilder-object="input">
				<label for="output_status">Status</label>
				<input type="text" style="float:left;" id="output_status" readonly >
			</div>
			<div class="input_element form_element" style="width:100%;overflow:hidden" data-appbuilder-object="input">
				<label for="output_octets_per_frame">Octets per frame</label>
				<input type="text" style="float:left;" id="output_octets_per_frame" readonly >
			</div>
			<div class="input_element form_element" style="width: 100%; overflow: hidden;" data-appbuilder-object="input">
				<label for="output_micros_per_frame">Âµs per frame</label>
				<input type="text" style="float:left;" id="output_micros_per_frame" readonly >
			</div>
			<div class="input_element form_element" style="width: 100%; overflow: hidden;" data-appbuilder-object="input">
				<label for="output_bw_per_stream_in_bps">bps used per stream</label>
				<input type="text" style="float:left;" id="output_bw_per_stream_in_bps" readonly >
			</div>
			<div class="input_element form_element" style="width:100%;overflow:hidden" data-appbuilder-object="input">
				<label for="output_max_stream_count_per_net_link">Max stream count per network link</label>
				<input type="text" style="float:left;" id="output_max_stream_count_per_net_link" readonly >
			</div>
			<div class="input_element form_element" style="width: 100%; overflow: hidden;" data-appbuilder-object="input">
				<label for="output_total_bw_used_in_bps">bps used for max stream count</label>
				<input type="text" style="float:left;" id="output_total_bw_used_in_bps" readonly >
			</div>

			<div class="input_element form_element" style="width:100%;overflow:hidden" data-appbuilder-object="input">
				<label for="output_leftover_bw_in_bps">Leftover bw in bps</label>
				<input type="text" style="float:left;" id="output_leftover_bw_in_bps" readonly >
			</div>
			<div class="input_element form_element" style="width:100%;overflow:hidden" data-appbuilder-object="input">
				<label for="output_total_channels_per_net_link">Total channels per network link</label>
				<input type="text" style="float:left;" id="output_total_channels_per_net_link" readonly >
			</div>
		</div>
	</div>
    <div class="panel" title="Details" id="page_details" data-appbuilder-object="page" style="width: 100%; overflow: hidden;">
		<div class="container scrollable" style="width:100%" data-appbuilder-object="container" data-position="static">
            <pre id="output_detail" style="width:100%;height:100%;"></pre>
        </div>
    </div>

</div>
            <div id="navbar">
                <a href="#page_inputs" class="icon home" id="inputs_button">Inputs</a>
                <a href="#page_answers" class="icon star" id="answers_button">Answers</a>
                <a href="#page_details" class="icon star" id="details_button">Details</a>
            </div>
        </div>
    </body>
</html>
